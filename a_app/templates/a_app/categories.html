{% extends "base.html" %}
{% block title %}Categories{% endblock title %}
{% block body %}

<div class="max-w-[1400px] mx-auto px-4 md:px-8 py-6 flex flex-col lg:flex-row gap-6">

  <aside class="w-full lg:w-52 bg-white rounded-xl p-6 shadow-md flex-shrink-0">
    <h2 class="text-xl font-semibold mb-6 text-gray-900">Categories</h2>
    <ul class="space-y-4">
      {% for category in categories %}
      <li>
        <a href="?category={{ category.id }}"
           class="block text-gray-600 font-medium hover:text-blue-600 hover:translate-x-1 transition-all duration-200 {% if current_category and current_category.id == category.id %}text-blue-600 font-semibold{% endif %}">
          {{ category.name }}
        </a>
      </li>
      {% endfor %}
    </ul>
  </aside>

  <main class="flex-1">
    <h1 class="text-2xl md:text-3xl lg:text-4xl font-bold mb-8 text-gray-900">
      {% if current_category %}{{ current_category.name }}{% else %}All Products{% endif %}
    </h1>

    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 justify-center gap-6">
      {% for product in products %}
      <div class="bg-white border border-gray-200 rounded-xl overflow-hidden shadow-md relative group transition-all duration-300 hover:shadow-lg hover:-translate-y-1">
        
        <button onclick="toggleWishlist(this, {{ product.id }})"
                class="absolute top-3 right-3 w-10 h-10 bg-white/90 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-all duration-200 hover:scale-110">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" class="w-4.5 h-4.5">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
          </svg>
        </button>

        {% if product.discount_price %}
        <span class="absolute top-3 left-3 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded">
          -{{ product.discount_percentage }}%
        </span>
        {% endif %}

        <img src="{{ product.image.url }}" alt="{{ product.name }}"
             class="w-full h-60 md:h-64 object-cover transition-transform duration-300 group-hover:scale-105">

        <div class="p-4 flex flex-col gap-2">
          <span class="text-xs uppercase tracking-wider text-gray-500 font-medium">{{ product.category.name }}</span>
          <h3 class="text-base md:text-lg font-semibold text-gray-900">{{ product.name }}</h3>

          <div class="flex items-center gap-3">
            {% if product.discount_price %}
            <span class="text-gray-400 line-through text-sm">Rs {{ product.price }}</span>
            <span class="text-black font-bold text-base md:text-lg">Rs {{ product.after_discount }}</span>
            {% else %}
            <span class="text-black font-bold text-base md:text-lg">Rs {{ product.price }}</span>
            {% endif %}
          </div>

          <div class="mt-2">
            <button onclick="addToCart({{ product.id }}, event)" data-login-url="{% url 'login' %}"
                    class="inline-flex items-center gap-2 px-3 py-2 bg-black text-white text-sm rounded-md font-medium transition-all duration-200 hover:bg-gray-800 hover:-translate-y-[1px]">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5M7 13l5.5 11"/>
              </svg>
              Add to Cart
            </button>
          </div>

        </div>
      </div>
      {% endfor %}
    </div>
  </main>
</div>
<script>
  const isAuthenticated = {{ user.is_authenticated|yesno:"true,false" }};
</script>

{% endblock body %}
